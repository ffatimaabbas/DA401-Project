"ADR"       = "#33a02c",
"Occupancy" = "#e31a1c"
)
) +
labs(
title = "Accommodation Metrics (2024/2025)",
x = "Month",
color = ""
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "top"
)
avg_room_rev2023 <- mean(room_rev2023)
room_rev2023 <- c(
7744544,
6314201,
6760938,
4965332,
3950222,
5381549,
6001506,
7038654,
7662164,
7479749,
7442923,
7644477
)
avg_room_rev2024 <- mean(room_rev2024)
avg_room_rev2025 <- mean(room_rev2025)
avg_room_rev2023 <- mean(room_rev2023)
avg_room_rev2023
avg_room_rev2024 <- mean(room_rev2024)
avg_room_rev2025 <- mean(room_rev2025)
avg_room_rev2023 <- mean(room_rev2023)
pct_change_room_rev_2025 <- (avg_room_rev2025 - avg_room_rev2024)/ avg_room_rev2024
pct_change_room_rev_2024 <- (avg_room_rev2024 - avg_room_rev2023)/ avg_room_rev2023
df <- data.frame(
year = c(2023, 2024, 2025),
avg_room_rev = c(
avg_room_rev2023,
avg_room_rev2024,
avg_room_rev2025
)
)
library(ggplot2)
ggplot(df, aes(x = factor(year), y = avg_room_rev)) +
geom_col(fill = "#1f78b4") +
coord_flip() +
labs(
title = "Average Room Revenue (2023–2025)",
x = "Year",
y = "Average Revenue ($)"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold", hjust = 0.5)
)
ggplot(df, aes(x = factor(year), y = avg_room_rev)) +
geom_col(fill = "#1f78b4") +
coord_flip() +
labs(
title = "Average Room Revenue (2023–2025)",
x = "Year",
y = "Average Revenue ($)"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold", hjust = 0.5)
) + scale_x_continuous(breaks = seq(0, max(df$avg_room_rev), by = 10))
ggplot(df, aes(x = avg_room_rev, y = factor(year))) +
geom_col(fill = "#1f78b4") +
scale_x_continuous(
breaks = scales::pretty_breaks(n = 10),
labels = scales::comma
) +
labs(
title = "Average Room Revenue (2023–2025)",
x = "Average Revenue ($)",
y = "Year"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold", hjust = 0.5)
)
ggplot(df, aes(x = avg_room_rev, y = factor(year))) +
geom_col(fill = "#1f78b4") +
scale_x_continuous(
breaks = scales::pretty_breaks(n = 1),
labels = scales::comma
) +
labs(
title = "Average Room Revenue (2023–2025)",
x = "Average Revenue ($)",
y = "Year"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold", hjust = 0.5)
)
ggplot(df, aes(x = avg_room_rev, y = factor(year))) +
geom_col(fill = "#1f78b4") +
scale_x_continuous(breaks = seq(0, max(df$avg_room_rev), by = 10))
) +
ggplot(df, aes(x = avg_room_rev, y = factor(year), fill = factor(year))) +
geom_col() +
scale_fill_manual(values = c("2023" = "#5EA4D3",
"2024" = "#6FC46A",
"2025" = "#E25451")) +
scale_x_continuous(
breaks = scales::pretty_breaks(n = 10),
labels = scales::comma
) +
labs(
title = "Average Room Revenue (2023–2025)",
x = "Average Revenue ($)",
y = "Year",
fill = "Year"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold", hjust = 0.5)
)
pct_change_room_rev_2025 <- (avg_room_rev2025 - avg_room_rev2024)/ avg_room_rev2024
pct_change_room_rev_2024 <- (avg_room_rev2024 - avg_room_rev2023)/ avg_room_rev2023
pct_change_room_rev_2025
pct_change_room_rev_2024
room_rev2023<- c(6908191, 6075001, 6235546, 4674689, 4604688,
6140002, 6652768, 7064169, 8168009, 8517399,
7629254, 8258796)
avg_room_rev2024 <- mean(room_rev2024)
avg_room_rev2025 <- mean(room_rev2025)
avg_room_rev2023 <- mean(room_rev2023)
pct_change_room_rev_2025 <- (avg_room_rev2025 - avg_room_rev2024)/ avg_room_rev2024
pct_change_room_rev_2024 <- (avg_room_rev2024 - avg_room_rev2023)/ avg_room_rev2023
pct_change_room_rev_2025 <- (avg_room_rev2025 - avg_room_rev2024)/ avg_room_rev2024
pct_change_room_rev_2024 <- (avg_room_rev2024 - avg_room_rev2023)/ avg_room_rev2023
pct_change_room_rev_2025
pct_change_room_rev_2024
pct_change_room_rev_2025
pct_change_room_rev_2024
library(ggplot2)
ggplot(df, aes(x = avg_room_rev, y = factor(year), fill = factor(year))) +
geom_col() +
scale_fill_manual(values = c("2023" = "#5EA4D3",
"2024" = "#6FC46A",
"2025" = "#E25451")) +
scale_x_continuous(
breaks = scales::pretty_breaks(n = 10),
labels = scales::comma
) +
labs(
title = "Average Room Revenue (2023–2025)",
x = "Average Revenue ($)",
y = "Year",
fill = "Year"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold", hjust = 0.5)
)
avg_room_rev2024 <- mean(room_rev2024)
avg_room_rev2025 <- mean(room_rev2025)
avg_room_rev2023 <- mean(room_rev2023)
avg_room_rev2024
avg_room_rev2023
pct_change_room_rev_2024
df <- data.frame(
year = c(2023, 2024, 2025),
avg_room_rev = c(
avg_room_rev2023,
avg_room_rev2024,
avg_room_rev2025
)
)
library(ggplot2)
ggplot(df, aes(x = avg_room_rev, y = factor(year), fill = factor(year))) +
geom_col() +
scale_fill_manual(values = c("2023" = "#5EA4D3",
"2024" = "#6FC46A",
"2025" = "#E25451")) +
scale_x_continuous(
breaks = scales::pretty_breaks(n = 10),
labels = scales::comma
) +
labs(
title = "Average Room Revenue (2023–2025)",
x = "Average Revenue ($)",
y = "Year",
fill = "Year"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold", hjust = 0.5)
)
ggplot(df, aes(x = avg_room_rev, y = factor(year), fill = factor(year))) +
geom_col(width = 0.4) +  # make bars skinnier (default is 0.9)
scale_fill_manual(values = c("2023" = "#5EA4D3",
"2024" = "#6FC46A",
"2025" = "#E25451")) +
scale_x_continuous(
breaks = scales::pretty_breaks(n = 10),
labels = function(x) x / 1e6  # scale to millions
) +
labs(
title = "Average Room Revenue (2023–2025)",
x = NULL,  # remove x-axis label
y = NULL,  # remove y-axis label
fill = "Year"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold", hjust = 0.5)
)
ggplot(df, aes(x = avg_room_rev, y = factor(year), fill = factor(year))) +
geom_col(width = 0.4) +  # make bars skinnier (default is 0.9)
scale_fill_manual(values = c("2023" = "#5EA4D3",
"2024" = "#6FC46A",
"2025" = "#E25451")) +
scale_x_continuous(
breaks = scales::pretty_breaks(n = 10),
labels = function(x) x / 1e6  # scale to millions
) +
labs(
title = "Average Monthly Room Revenue (2023–2025)",
x = "Monthly Room Revenue (in millions of $)" ,  # remove x-axis label
y = NULL,  # remove y-axis label
fill = "Year"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "bold", hjust = 0.5)
)
ggplot(df, aes(x = avg_room_rev, y = factor(year), fill = factor(year))) +
geom_col(width = 0.4) +  # make bars skinnier (default is 0.9)
scale_fill_manual(values = c("2023" = "#5EA4D3",
"2024" = "#6FC46A",
"2025" = "#E25451")) +
scale_x_continuous(
breaks = scales::pretty_breaks(n = 10),
labels = function(x) x / 1e6  # scale to millions
) +
labs(
title = "Average Monthly Room Revenue (2023–2025)",
x = "Monthly Room Revenue (in millions of $)" ,  # remove x-axis label
y = NULL,  # remove y-axis label
fill = "Year"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "plain", hjust = 0.5)
)
ggplot(df, aes(x = avg_room_rev, y = factor(year), fill = factor(year))) +
geom_col(width = 0.4) +  # make bars skinnier (default is 0.9)
scale_fill_manual(values = c("2023" = "#5EA4D3",
"2024" = "#6FC46A",
"2025" = "#E25451")) +
scale_x_continuous(
breaks = scales::pretty_breaks(n = 10),
labels = function(x) x / 1e6  # scale to millions
) +
labs(
title = "Average Monthly Room Revenue",
x = "Monthly Room Revenue (in millions of $)" ,  # remove x-axis label
y = NULL,  # remove y-axis label
fill = "Year"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "plain", hjust = 0.5)
)
source("~/.active-rstudio-document", echo=TRUE)
ggsave(
"rev_graph.png",
dpi = 300
)
ggsave(
"rev_graph.png",
dpi = 300,
length="5",
units = "in"
)
ggsave(
"rev_graph.png",
width = 7,
height = 5,   # not ridiculously tall
units = "in",
dpi = 300
)
ggplot(df, aes(x = year, y = avg_room_rev, fill = factor(year))) +
geom_col(width = 0.4) +  # make bars skinnier (default is 0.9)
scale_fill_manual(values = c("2023" = "#5EA4D3",
"2024" = "#6FC46A",
"2025" = "#E25451")) +
scale_x_continuous(
breaks = scales::pretty_breaks(n = 10),
labels = function(x) x / 1e6  # scale to millions
) +
labs(
title = "Average Monthly Room Revenue",
x = "Monthly Room Revenue (in millions of $)" ,  # remove x-axis label
y = NULL,  # remove y-axis label
fill = "Year"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "plain", hjust = 0.5)
)
ggplot(df, aes(x = year, y = avg_room_rev, fill = factor(year))) +
geom_col(width = 0.2) +  # make bars skinnier (default is 0.9)
scale_fill_manual(values = c("2023" = "#5EA4D3",
"2024" = "#6FC46A",
"2025" = "#E25451")) +
scale_x_continuous(
breaks = scales::pretty_breaks(n = 10),
labels = function(x) x / 1e6  # scale to millions
) +
labs(
title = "Average Monthly Room Revenue",
x = "Monthly Room Revenue (in millions of $)" ,  # remove x-axis label
y = NULL,  # remove y-axis label
fill = "Year"
) +
theme_minimal(base_size = 12) +
theme(
plot.title = element_text(face = "plain", hjust = 0.5)
)
avg_room_rev2024
avg_room_rev2025
avg_room_rev2023
tax_impacts <- read_csv("fiscal_tax_impacts_2024.csv")
A <- matrix(c(
1,   4,   3,   1/4,   1,
1/4,   1,   1/4,   1/2,   1/4,
1/3,   4,   1,   ,2, 1/3,
4, 2,   1/2,   1,   6,
1, 4, 3, 1/6, 1
),
nrow = 5,
byrow = TRUE)
A <- matrix(c(
1,   4,   3,   1/4,   1,
1/4,   1,   1/4,   1/2,   1/4,
1/3,   4,   1, 2, 1/3,
4, 2,   1/2,   1,   6,
1, 4, 3, 1/6, 1
),
nrow = 5,
byrow = TRUE)
eig <- eigen(A)
# Find the principal eigenvector (the one corresponding to the largest eigenvalue)
principal_eigvec <- eig$vectors[,1]
# Normalize it (so all weights sum to 1)
weights <- principal_eigvec / sum(principal_eigvec)
# View the normalized weights
weights
principal_eigvec <- eig$vectors[,1] #get principal eigenvector
principal_eigvec
eig <- eigen(A)
eig
principal_eigvec <- eig$vectors[,1] #get principal eigenvector
principal_eigvec
install.packages("AHPWR")
library(AHPWR)
ahp_geral(A)
ahp_eig(A)
ahp_eig(A)
calculate_ahp(A)
T <- tabela_holistica(pesos = A)
calc_eigen(A)
eigen_values <- eigen_decomposition$values
eigen_values <- eig$values
eigen_values
A <- matrix(c(
1,   4,   3,   1/4,   1,
1/4,   1,   1/4,   1/2,   1/4,
1/3,   4,   1, 2, 1/3,
4, 2,   1/2,   1,   6,
1, 4, 3, 1/6, 1
),
nrow = 5,
byrow = TRUE)
eig <- eigen(A)
principal_eigvec <- eig$vectors[,1] #get principal eigenvector
principal_eigvec
eigen_values <- eig$values
eigen_values <- eig$values
principal_eigenvalue <- eigen_values$values[1]
principal_eigenvalue <- eigen_values[1]
principal_eigenvalue
CI <- (principal_eigenvalue - c )/(c-1)
principal_eigenvalue <- eigen_values[1]
CI <- (principal_eigenvalue - c )/(c-1)
c <- 5 #no. of criteria
CI <- (principal_eigenvalue - c )/(c-1)
CI
CI <- CI / 1.12
CI
A <- matrix(c(
1,   4,   3,   1/4,   1,
1/4,   1,   1/4,   1/2,   1/4,
1/3,   4,   1, 2, 1/3,
4, 2,   1/2,   1,   6,
1, 4, 3, 1/6, 1
),
nrow = 5,
byrow = TRUE)
eig <- eigen(A)
principal_eigvec <- eig$vectors[,1] #get principal eigenvector
weights <- principal_eigvec / sum(principal_eigvec) #normalize
weights
library(readr)
literacy <- read.csv("district_literacy_rates.csv")
setwd("~/Documents/DA401-Project/Attribute tables")
library(readr)
literacy <- read.csv("district_literacy_rates.csv")
literacy$District <- toupper(literacy$District)
literacy <- literacy %>% rename(DISTRICT = District)
table2$Value <- 1:nrow(table2) #adding value col so i can left join
##### trying something new
library(foreign)
table1 <-read.dbf("District_FloodRisk.dbf", as.is = FALSE)
table2 <- read.dbf("Study_area.dbf", as.is = FALSE)
head(table1)
head(table2)
table2$Value <- 1:nrow(table2) #adding value col so i can left join
floodrisk_district <- left_join(table1, table2, by = "Value")
library(dplyr)
library(foreign)
table1 <-read.dbf("District_FloodRisk.dbf", as.is = FALSE)
table2 <- read.dbf("Study_area.dbf", as.is = FALSE)
head(table1)
head(table2)
table2$Value <- 1:nrow(table2) #adding value col so i can left join
floodrisk_district <- left_join(table1, table2, by = "Value")
#next, we add educ table
library(readr)
literacy <- read.csv("district_literacy_rates.csv")
literacy$District <- toupper(literacy$District)
literacy <- literacy %>% rename(DISTRICT = District)
district_info <- left_join(floodrisk_district, literacy, by = "DISTRICT") #added district literacy rates to full table
district_clean <- district_info[!is.na(district_info$Literacy.Rate), ]
floodrisk_education <- lm(MAJORITY ~ Literacy.Rate, data = district_clean)
summary(floodrisk_education)
floodrisk_education <- lm(Literacy.Rate ~ MAJORITY, data = district_clean)
summary(floodrisk_education)
plot(district_clean$Literacy.Rate, district_clean$MAJORITY)
c <- 5 #no. of criteria
CI
A <- matrix(c(
1,1,2/3,1/2,2,
1,1,2/3,1/2,2,
3/2,3/2,1,3/4,3,
2,2,4/3,1,4,
1/2,1/2,1/3,1/4,1
),
nrow = 5,
byrow = TRUE)
eig <- eigen(A)
principal_eigvec <- eig$vectors[,1] #get principal eigenvector
weights <- principal_eigvec / sum(principal_eigvec) #normalize
weights
#check for consistency
eigen_values <- eig$values
principal_eigenvalue <- eigen_values[1]
c <- 5 #no. of criteria
#plugging into the formula
CIRI <- (principal_eigenvalue - c )/(c-1)
CI <- CI / 1.12
CI
principal_eigvec <- eig$vectors[,1] #get principal eigenvector
principal_eigvec
library(foreign)
table1 <-read.dbf("District_FloodRisk.dbf", as.is = FALSE)
table2 <- read.dbf("Study_area.dbf", as.is = FALSE)
head(table1)
head(table2)
table2$Value <- 1:nrow(table2) #adding value col so i can left join
floodrisk_district <- left_join(table1, table2, by = "Value")
#next, we add educ table
library(readr)
literacy <- read.csv("district_literacy_rates.csv")
literacy$District <- toupper(literacy$District)
literacy <- literacy %>% rename(DISTRICT = District)
district_info <- left_join(floodrisk_district, literacy, by = "DISTRICT") #added district literacy rates to full table
district_clean <- district_info[!is.na(district_info$Literacy.Rate), ]
floodrisk_education <- lm(Literacy.Rate ~ MAJORITY, data = district_clean)
summary(floodrisk_education)
plot(district_clean$Literacy.Rate, district_clean$MAJORITY)
#next, we add educ table
install.packages("texreg")
library(texreg)
texreg(floodrisk_education)
district_info <- left_join(floodrisk_district, literacy, by = "DISTRICT") #added district literacy rates to full table
library(foreign)
table1 <-read.dbf("District_FloodRisk.dbf", as.is = FALSE)
table2 <- read.dbf("Study_area.dbf", as.is = FALSE)
head(table1)
head(table2)
table2$Value <- 1:nrow(table2) #adding value col so i can left join
floodrisk_district <- left_join(table1, table2, by = "Value")
#next, we add educ table
install.packages("texreg")
library(texreg)
library(readr)
literacy <- read.csv("district_literacy_rates.csv")
literacy$District <- toupper(literacy$District)
literacy <- literacy %>% rename(DISTRICT = District)
district_info <- left_join(floodrisk_district, literacy, by = "DISTRICT") #added district literacy rates to full table
district_info
